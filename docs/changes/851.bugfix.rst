The `simple_ir` method in class `simulator` now takes into account phase and edge cases.